<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:json-logger="http://www.mulesoft.org/schema/mule/json-logger"
	xmlns:sockets="http://www.mulesoft.org/schema/mule/sockets"
	xmlns:oauth="http://www.mulesoft.org/schema/mule/oauth"
	xmlns:tls="http://www.mulesoft.org/schema/mule/tls" xmlns:ibm-mq="http://www.mulesoft.org/schema/mule/ibm-mq"
	xmlns:os="http://www.mulesoft.org/schema/mule/os"
	xmlns:anypoint-mq="http://www.mulesoft.org/schema/mule/anypoint-mq" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:apikit="http://www.mulesoft.org/schema/mule/mule-apikit" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:api-gateway="http://www.mulesoft.org/schema/mule/api-gateway" xmlns:secure-properties="http://www.mulesoft.org/schema/mule/secure-properties" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/sockets http://www.mulesoft.org/schema/mule/sockets/current/mule-sockets.xsd 
http://www.mulesoft.org/schema/mule/mule-apikit http://www.mulesoft.org/schema/mule/mule-apikit/current/mule-apikit.xsd 
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/secure-properties http://www.mulesoft.org/schema/mule/secure-properties/current/mule-secure-properties.xsd
http://www.mulesoft.org/schema/mule/api-gateway http://www.mulesoft.org/schema/mule/api-gateway/current/mule-api-gateway.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/anypoint-mq http://www.mulesoft.org/schema/mule/anypoint-mq/current/mule-anypoint-mq.xsd
http://www.mulesoft.org/schema/mule/os http://www.mulesoft.org/schema/mule/os/current/mule-os.xsd
http://www.mulesoft.org/schema/mule/ibm-mq http://www.mulesoft.org/schema/mule/ibm-mq/current/mule-ibm-mq.xsd
http://www.mulesoft.org/schema/mule/tls http://www.mulesoft.org/schema/mule/tls/current/mule-tls.xsd
http://www.mulesoft.org/schema/mule/oauth http://www.mulesoft.org/schema/mule/oauth/current/mule-oauth.xsd
http://www.mulesoft.org/schema/mule/json-logger http://www.mulesoft.org/schema/mule/json-logger/current/mule-json-logger.xsd">
	<!-- <configuration-properties doc:name="Configuration properties" doc:id="25c05da0-330c-4801-8837-37d6c66ead2d" file="properties\local.yaml" /> -->
	 <apikit:config name="sgst-pmpc-gitp-sapi-config" api="sgst-pmpc-gitp-sapi.raml" outboundHeadersMapName="outboundHeaders" httpStatusVarName="httpStatus" />
	 <json-logger:config name="JSON_Logger_Config" doc:name="JSON Logger Config" doc:id="05be9735-f922-4a03-87ce-6d6d1a542c58" environment="${mule.env}" />
	 <http:listener-config name="sgst-pmpc-gitp-sapi-httpListenerConfig">
        <http:listener-connection host="${http.host}" port="${http.port}" readTimeout="${http.ReadTimeout}" protocol="HTTPS">
			<tls:context >
				<tls:key-store type="jks" path="${http.keystore.path}" alias="${http.keystore.alias}" keyPassword="${secure::http.keystore.password}" password="${secure::http.keystore.password}" />
			</tls:context>
		</http:listener-connection>
    </http:listener-config>
	<api-gateway:autodiscovery apiId="${api.autodiscovery.id}" ignoreBasePath="true" doc:name="API Autodiscovery" doc:id="bc5f4b4c-7303-4988-9784-4190dd3eae28" flowRef="sgst-pmpc-gitp-sapi-main" />
	<global-property doc:name="Global Property" doc:id="74c4c474-7c89-46ef-8f62-85afac19625e" name="mule.env" value="sit" />
	<configuration-properties doc:name="Configuration properties" doc:id="057932e3-90cf-4dec-86a0-627e71a0055d" file="properties/${mule.env}.yaml" />
	<secure-properties:config name="Secure_Properties_Config" doc:name="Secure Properties Config" doc:id="db4504d2-4231-4906-875a-1cbdd1f6fe3a" file="properties/${mule.env}.yaml" key="${secret.key}" />
	<configuration doc:name="Configuration" doc:id="de615457-ca54-4818-8f6e-2e1c8463ad76" defaultErrorHandler-ref="common-exception-handler" />
	<configuration-properties doc:name="Configuration properties" doc:id="4118f3bf-9aba-42c8-8468-fc9f23e459ff" file="properties\common.yaml" />
	<ibm-mq:config name="IBM_MQ_PMPC_Config" doc:name="IBM MQ Config" doc:id="94b6973b-bb22-443a-86c8-e1c0645901bc" >
		<ibm-mq:connection specification="JMS_1_1" targetClient="NO_JMS_COMPLIANT">
			<ibm-mq:connection-mode >
				<ibm-mq:client host="${ibmMQ.pmpc.host}" port="${ibmMQ.pmpc.port}" queueManager="${ibmMQ.pmpc.queueManager}" channel="${ibmMQ.pmpc.channel}" />
			</ibm-mq:connection-mode>
		</ibm-mq:connection>
	</ibm-mq:config>
	<http:request-config name="HTTP_Request_ObjectStore_configuration" doc:name="HTTP Request configuration" doc:id="6cd02c16-d19b-430d-a45f-f9ee119da7c2" basePath="${http.ob.basePath}" >
		<http:request-connection host="${http.ob.host}" port="${http.ob.port}" protocol="HTTPS">
			<http:authentication >
				<oauth:client-credentials-grant-type clientId="${http.ob.client_id}" clientSecret="${secure::http.ob.client_secret}" tokenUrl="${http.ob.tokenURL}" />
			</http:authentication>
		</http:request-connection>
	</http:request-config>
	<global-property doc:name="Global Property" doc:id="017b9a15-df53-40aa-92bd-72b0d355622a" name="secret.key" value="PanasonicDev2022" />
	<error-handler name="common-exception-handler" doc:id="c65de37b-031a-45e4-ad71-eeea6f2645f1" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="73db5dc1-662c-42f8-b09e-f51f9d6b00fb" type="COMPRESSION:COULD_NOT_DECOMPRESS, COMPRESSION:INVALID_ARCHIVE, COMPRESSION:TOO_MANY_ENTRIES" >
			<flow-ref doc:name="global-config-propagate-error" doc:id="c64ce6c9-d239-47c0-9723-722326d56add" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="2d0bf340-6854-49d1-8ff9-6936a53039f5" type="APIKIT:BAD_REQUEST">
			<flow-ref doc:name="global-config-propagate-error" doc:id="e0eb6790-2205-4b98-bcf1-5307bb4f1441" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="4c0ddd44-298e-4372-bb30-828fffe2916d" type="APIKIT:NOT_FOUND" >
			<flow-ref doc:name="global-config-propagate-error" doc:id="3b6f53da-bcf5-45cf-841a-70af50da3c56" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="e75fb148-e81b-4595-aaed-7bc6ab303bdc" type="APIKIT:METHOD_NOT_ALLOWED" >
			<flow-ref doc:name="global-config-propagate-error" doc:id="5e1097a2-dd3f-4391-88be-47cb0bdef4c4" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="37bad909-a982-4a69-9980-42d15d6e3a86" type="APIKIT:NOT_ACCEPTABLE" >
			<flow-ref doc:name="global-config-propagate-error" doc:id="4ce8215e-74fd-4b87-a821-7d8300b73386" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="ae069c1f-ba75-4291-b95e-bda8a2a5ec7e" type="APIKIT:UNSUPPORTED_MEDIA_TYPE" >
			<flow-ref doc:name="global-config-propagate-error" doc:id="7cd30f47-778b-4831-b79d-a6ed7e9b4787" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="073c7f1b-2edf-488e-8a87-5bb78023ca06" type="APIKIT:NOT_IMPLEMENTED" >
			<flow-ref doc:name="global-config-propagate-error" doc:id="529e23cb-6ff1-4024-b3f0-0904ff83f41c" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="7289eafa-49f4-4a5a-b6e1-114517813eb6" type="HTTP:BAD_REQUEST, HTTP:CLIENT_SECURITY, HTTP:CONNECTIVITY, HTTP:FORBIDDEN, HTTP:INTERNAL_SERVER_ERROR, HTTP:METHOD_NOT_ALLOWED, HTTP:NOT_ACCEPTABLE, HTTP:NOT_FOUND, HTTP:PARSING, HTTP:RETRY_EXHAUSTED, HTTP:SECURITY, HTTP:SERVICE_UNAVAILABLE, HTTP:TIMEOUT, HTTP:TOO_MANY_REQUESTS, HTTP:UNAUTHORIZED, HTTP:UNSUPPORTED_MEDIA_TYPE">
			<flow-ref doc:name="global-config-propagate-error" doc:id="1d6a69ca-598d-4ffb-a388-29018c34c87b" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="e1df0b2b-503f-488a-a1c3-0cb6110ccef3" type="HTTP:BAD_GATEWAY">
			<flow-ref doc:name="global-config-propagate-error" doc:id="6fa2901f-32a0-4fb3-a701-3a8fb1a3894d" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="6b68b168-33ec-4a77-aa62-541d0b00a7e2" type="HTTP:GATEWAY_TIMEOUT">
			<flow-ref doc:name="global-config-propagate-error" doc:id="0048d407-ef22-48bc-a30a-0734e7b051e5" name="global-config-propagate-error"/>
		
</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="da0ff3d4-938e-48b1-9f70-3b650664b014" type="ANY">
			<flow-ref doc:name="global-config-propagate-error" doc:id="98ca189e-153e-40d2-a16f-a45c73e75fcd" name="global-config-propagate-error"/>
		
</on-error-propagate>
	</error-handler>
	<sub-flow name="global-config-propagate-error" doc:id="ac437bba-650b-4d88-a9d9-cf4126d8f072" >
		<ee:transform doc:name="Frame Error Message" doc:id="24d2c1d3-dcb8-481d-8f5b-31f1a0a112fe">
				<ee:message>
				<ee:set-payload resource="dwl/errorResponse.dwl" />

				</ee:message>
			<ee:variables >
			</ee:variables>
			
</ee:transform>
		<json-logger:logger doc:name="Log Exception Details" doc:id="ea86e8e2-bdd5-4756-951e-d7e7376e26f9" config-ref="JSON_Logger_Config" message='Exception occurred processing the transaction' tracePoint="EXCEPTION" priority="ERROR" correlationId="#[vars.TransactionID]">
		</json-logger:logger>
	
</sub-flow>
</mule>
